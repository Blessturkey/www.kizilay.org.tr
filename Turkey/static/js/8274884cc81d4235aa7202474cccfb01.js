function GetURLParameter(){var n=window.location.href,t=n.lastIndexOf("/");return t>0&&n.length-1!=t?n.substring(t+1):0}function BagisciGirisiTabla(){$("#tab-container").easytabs({updateHash:!1,animate:!0,animationSpeed:300})}function IpGetirDoldur(n){try{$.ajax({url:"https://webyardimciservis.kizilay.org.tr/bagis/IpGetir",data:{IpKontrolEt:n},type:"POST",jsonp:"callback",dataType:"jsonp",async:!0,success:function(t){$("#IpNumber").val(t.IpNumber);$("#IpZaman").val(t.IpZaman);$("#IpPass").val(t.IpPass);$("#IpYurtdisi").val(t.IpYurtdisi);n&&(!t.IpYurtdisi||t.IpNumber<=7)&&$("#bagisodemesecenekleritabbaslikyurtdisi").hide()}})}catch(t){}}function crossDomainAjax(n,t){if("XDomainRequest"in window&&window.XDomainRequest!==null){var i=new XDomainRequest;i.open("get",n);i.onload=function(){var r=new ActiveXObject("Microsoft.XMLDOM"),n=$.parseJSON(i.responseText);r.async=!1;(n==null||typeof n=="undefined")&&(n=$.parseJSON(data.firstChild.textContent));t(n)};i.onerror=function(){_result=!1};i.send()}else{if(navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.match(/MSIE ([\d.]+)/)[1],10)<8)return!1;$.ajax({url:n,cache:!1,dataType:"json",type:"GET",async:!1,success:function(n){t(n)}})}}function BilgiDegistir(n){$("#bagisMod").html($(n).data("val"));$("#bagisMod2").html($(n).data("val"))}function numericFilter(n){n=n?n:window.event;var t=n.which?n.which:n.keyCode;return t>31&&(t<48||t>57)?!1:!0}function userLogin(){$("#frmLogin #Kod").val()==""||$("#frmLogin #Sifre").val()==""?MsgBox("error",Translate("Lütfen Kullanıcı Adı ve Şifrenizi Eksiksiz Giriniz!"),Translate("Kullanıcı Giriş")):$.ajax({url:"/Bagis/UserLogin",data:$("#frmBagisAntiForgeryForm").serialize()+"&"+$("#frmLogin").serialize(),type:"POST",async:!1,success:function(n){n.indexOf("KullaniciGirisiYapildi")!==-1?($("#BagisciGirisiHolder").remove(),$("#bagisYapBigContainer").prepend(n),$("#BagisciGirisiHolder").css({display:"none"}),$("#BagisciGirisiHolder").fadeIn("slow"),AntiForgeryTokenOlustur()):MsgBox("error",$($.parseHTML(n)).find("input").val(),Translate("Upss! Birşeyler Yanlış Gitti"))},error:function(){alert("Kullanıcı girişi gerçekleştirilemedi, lütfen internet bağlantınızı kontrol edip tekrar deneyiniz")}})}function FiyatKontrol(n){return(code=n.keyCode?n.keyCode:n.which,code>31&&(code<48||code>57)&&code!=44)?!1:(code.toString()!="37"&code.toString()!="39"&&$("#BagisTutari").val(formatCurrency($("#BagisTutari").val())),!0)}function formatCurrency(n){var i=n.replace(".",""),t;return i=i.replace(".",""),t="",i.indexOf(",")!=-1&&(i=n.split(",")[0],t=n.split(",")[1],t=t.lenght>=2?t+"0":t.substring(0,2),t=","+t),i+t}function OdemeKontrol(){var t,i,n;return $(".btn_bagisyap").hide(),loadingGoster(),t=ValidationForms(),i="",t==""?(TutarHesapla(),BagisciKontrol(),EkbagisYap(),n=!0,$.ajax({url:"/Bagis/BankPostData",data:$("#frmBagisAntiForgeryForm").serialize()+"&"+$("#frmPayment").serialize()+"&"+$("#frmBagisOdeme").serialize()+"&"+$("#frmBagisTuru").serialize(),type:"POST",async:!1,success:function(n){n.Durum==1?($("#OkUrl").val(n.OkUrl),$("#FailUrl").val(n.FailUrl),$("#OId").val(n.OId),$("#SiparisKontrol").val(n.OId),i=n.HashData,$("#ClientId").val(n.ClientId)):(loadingGizle(),MsgBox("error",n.Mesaj,Translate("Upss! Birşeyler Yanlış Gitti")))},error:function(){n=!0;loadingGizle();alert("İşlem gerçekleştirilemedi, lütfen internet bağlantınızı kontrol edip tekrar deneyiniz")}}),$.ajax({url:"/Bagis/ModelKayit",data:$("#frmBagisAntiForgeryForm").serialize()+"&"+$("#frmPayment").serialize()+"&"+$("#frmBagisOdeme").serialize()+"&"+$("#frmBagisTuru").serialize()+"&"+$("#frmDuzenliBagis").serialize()+"&"+$("#frmYeniKullanici").serialize()+"&"+$("#frmBagisIp").serialize()+"&BKMExpress=false&",type:"POST",async:!1,success:function(t){t.Durum==0?(n=!0,loadingGizle(),MsgBox("error",t.Mesaj,Translate("Upss! Birşeyler Yanlış Gitti"))):(n=!1,$("#Hash").val(i))},error:function(){n=!0;alert("İşlem gerçekleştirilemedi, lütfen internet bağlantınızı kontrol edip tekrar deneyiniz")}}),n?($(".btn_bagisyap").show(),loadingGizle()):parent.postMessage("BasaDon","*"),!n):(MsgBox("error",t,Translate("Upss! Birşeyler Yanlış Gitti")),$(".btn_bagisyap").show(),loadingGizle(),!1)}function AntiForgeryTokenOlustur(){$.ajax({url:"/Bagis/AntiForgeryTokenOlustur",type:"POST",async:!1,success:function(n){$("#antiForgeryTokenHolder").remove();$("#bagisYapBigContainer").append(n)},error:function(){alert("İşlem gerçekleştirilemedi, lütfen internet bağlantınızı kontrol edip tekrar deneyiniz")}})}function BagisYapAdAyarla(){try{$("#hdnKampanyaTurId").val()=="1"&&($(".btn_bagisyap").prop("value",Translate("Vekalet Ver")),$(".BagisYapYazi").html(Translate("Vekalet Ver")))}catch(n){}}function bagisTuruDegistir(){var n=$("#KampanyaID").val();window.location="/Bagis/BagisYap/"+n}function TutarHesapla(){var n;if($("#BagisAdeti").val()==""||$("#BagisAdeti").val()==undefined||isNaN(parseFloat($("#BagisTutari").val()))){if(isNaN(parseFloat($("#BagisTutari").val()))){$("#BagisTutari").val("");return}n=parseFloat($("#BagisTutari").val())}else n=parseFloat($("#BirimFiyati").val())*parseInt($("#BagisAdeti").val());EkbagisYap()}function EkbagisYap(){var n;if($("#BagisAdeti").val()==""||$("#BagisAdeti").val()==undefined||isNaN(parseFloat($("#BagisTutari").val()))){if(isNaN(parseFloat($("#BagisTutari").val()))){$("#BagisTutari").val("");return}n=parseFloat($("#BagisTutari").val())}else n=parseFloat($("#BirimFiyati").val())*parseInt($("#BagisAdeti").val());$("#BagisTutari").val(n.toFixed(2).replace(".",","));$("#EkBagisDurumu").length&&($("#EkBagisDurumu").prop("checked")==!1?n=isNaN(parseFloat($("#BagisTutari").val()))?0:parseFloat($("#BagisTutari").val()):isNaN(parseFloat($("#BagisTutari").val()))||(n+=parseFloat($("#EkBagisTutari").val())));$("#Amount").val(n.toFixed(2));$("#toplamGoruntu").html(n.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2}));$("#fptoplamGoruntu").length>0&&($("#fptoplamGoruntu").html(n.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})),$("#fpAmount").val(n.toFixed(2)))}function EuroHesaplaYaz(){try{$.ajax({url:"/Bagis/EuroToTlEfektifSale",type:"POST",async:!1,success:function(n){n.Durum&&$("#EuroKur").val(n.EuroKur)},error:function(){hasError=!0;alert("İşlem gerçekleştirilemedi, lütfen internet bağlantınızı kontrol edip tekrar deneyiniz")}})}catch(n){}}function bagisciEkle(){bagisciEkleDolu("","","","")}function bagisciEkleDolu(n,t,i,r){$(".ekBagisciHolder").length<parseInt($("#BagisAdeti").val())?(n=n==null?"":n,t=t==null?"":t,i=i==null?"":i,r=r==null?"":r,$("#tblEkBagisci").append('<div class="row ekBagisciHolder"><div class="col-md-6 col-sm-6 pr-10"><input class="form-control required" type="text" value="'+n+'" name="EkBagisciAd"  maxlength="40"  placeholder="'+Translate("Ad")+'"/><\/div><div class="col-md-6 col-sm-6 pr-10">\t\t\t\t<input class="form-control required" type="text" value="'+t+'" name="EkBagisciSoyad" maxlength="40" placeholder="'+Translate("Soyad")+'"/><\/div><div class="col-md-6 col-sm-6 pr-10"><input class="form-control required" type="text" value="'+r+'" name="EkBagisciEmail" maxlength="241"  placeholder="'+Translate("Email")+'"/>\t<\/div><div class="col-md-4 col-sm-6 col-xs-9 pr-10"><input class="form-control required" type="text" value="'+i+'" name="EkBagisciGSM" maxlength="30"  placeholder="'+Translate("GSM")+'"/><\/div><div class="col-md-2 col-sm-6 col-xs-3  pt-0"><a href="javascript:void(0)" class="remove" onclick="bagisciKopyala(this)" title="'+Translate("İlk vekaletçinin bilgilerini kullan.")+'"><img src="/assets/images/UserCopy.png" class="float-right" width="30" height="30" alt="'+Translate("İlk vekaletçinin bilgilerini kullan.")+'"/><\/a><\/div><\/div>')):MsgBox("error",Translate("Yalnızca ")+$("#BagisAdeti").val()+Translate(" adet vekaletci ekleyebilirsiniz."),Translate("Vekaletci Ekleme"))}function bagisciAdetiDuzenle(){var n;if(parseInt($("#BagisAdeti").val())>1?$("#divIlkBagisHepsineKopyala").show():$("#divIlkBagisHepsineKopyala").hide(),$(".ekBagisciHolder").length<parseInt($("#BagisAdeti").val()))for(n=$(".ekBagisciHolder").length;n<parseInt($("#BagisAdeti").val());n++)bagisciEkle();$(".ekBagisciHolder").length>parseInt($("#BagisAdeti").val())&&(n=1,$(".ekBagisciHolder").each(function(t,i){n>parseInt($("#BagisAdeti").val())&&$(i).remove();n++}))}function bagisciSil(n){$(n).closest(".ekBagisciHolder").remove()}function bagisciKopyala(n){$(n).closest(".ekBagisciHolder").find("input[name='EkBagisciAd']").val($("#EkBagisciAd").val());$(n).closest(".ekBagisciHolder").find("input[name='EkBagisciSoyad']").val($("#EkBagisciSoyad").val());$(n).closest(".ekBagisciHolder").find("input[name='EkBagisciEmail']").val($("#EkBagisciEmail").val());$(n).closest(".ekBagisciHolder").find("input[name='EkBagisciGSM']").val($("#EkBagisciGSM").val())}function bagisciKopyalaHepsi(){$("input[name='EkBagisciAd']").val($("#EkBagisciAd").val());$("input[name='EkBagisciSoyad']").val($("#EkBagisciSoyad").val());$("input[name='EkBagisciEmail']").val($("#EkBagisciEmail").val());$("input[name='EkBagisciGSM']").val($("#EkBagisciGSM").val())}function closLoginBox(){$("#BagisciGirisiHolder").fadeOut()}function BagisciKontrol(){var n=$("#BagisAdeti").val();n>0}function DuzenliBagisAdetDegistir(){var n=$("#DuzenliBagisAdedi").val(),i=new Date,t=i.getDate().toString(),r="*"+Translate("Bağışta bulunmak istediğiniz tutar")+" <b>"+n+"<\/b>"+Translate(" ay boyunca, her ayın")+" <b>"+t+"<\/b>. "+Translate("günü kredi kartınızdan tahsil edilecektir.");$(".duzenlibagismesaj").html(r);$("#RecurringTotalPaymentNum").val(n);$("#RecurringStartDate").val(t)}function DuzenliBagisYapmakIstiyorum(){$("#DuzenliBagisYapmakIstiyorum").is(":checked")?($("#frmDuzenliBagis").fadeIn(),$("#DuzenliBagisciOl").val("true"),$("#Recurring").val("true")):($("#frmDuzenliBagis").fadeOut(),$("#DuzenliBagisciOl").val("false"),$("#Recurring").val("false"))}function ValidationForms(){var n="",i,t;return $(":input[name=EkBagisciAd]").each(function(){var t=$(this);$.trim(t.val())==""&&(n=" * "+Translate("Lütfen vekaletçilerin isimlerini giriniz.")+"<br/>")}),$(":input[name=EkBagisciSoyad]").each(function(){var t=$(this);$.trim(t.val())==""&&(n=" * "+Translate("Lütfen vekaletçilerin soyisimlerini giriniz.")+"<br/>")}),i=!1,t=!1,$(":input[name=EkBagisciEmail],:input[name=EkBagisciGSM]").each(function(){var r=$(this);r.attr("name")=="EkBagisciEmail"?(i=!0,$.trim(r.val())==""?t=!0:ValidateEmail($.trim(r.val()))||(n=" * "+Translate("Lütfen geçerli bir email adresi giriniz.")+"<br/>")):(t&&$.trim(r.val())==""&&(n=" * "+Translate("Lütfen vekaletçilerin telefon ya da emailini giriniz.")+"<br/>"),i=!1,t=!1)}),($("#LoginDurumu").val()==""||$("#LoginDurumu").val()=="False")&&($("#YeniKullanici_YeniAd").val()==""||$("#YeniKullanici_YeniSoyad").val()==""||$("#YeniKullanici_YeniEmail").val()==""?n=" * "+Translate("Lütfen Bağışçı Bilgileriniz bölümünde sizden istenen bilgileri eksiksiz doldurunuz.")+"<br/>":ValidateEmail($("#YeniKullanici_YeniEmail").val())||(n=" * "+Translate("Lütfen geçerli bir email adresi giriniz.")+"<br/>")),$("#BagisTutari").val()==""?n+=" * "+Translate("Lütfen geçerli bir tutar giriniz.")+"<br/>":((GetURLParameter()=="fitre"||GetURLParameter()=="fitra")&&parseFloat($("#BagisTutari").val())<40&&(n+=" * "+Translate("Fitre miktarı 28 TL den az olamaz.")+"<br/>"),(GetURLParameter()=="fidye"||GetURLParameter()=="fidya")&&parseFloat($("#BagisTutari").val())<40&&(n+=" * "+Translate("Fidye miktarı 28 TL den az olamaz.")+"<br/>")),$("#DuzenliBagisYapmakIstiyorum").is(":checked")&&$("#DuzenliBagisAdedi").val()==""&&(n+=" * "+Translate("Lütfen düzenli bağış yapmak istediğiniz ay sayısını seçiniz.")+"<br/>"),$("#KvkkIsaretlendi").is(":checked")||(n+=" * "+Translate("Kişisel Verilerin Korunması Politikamızı okuduğunuzu onaylayınız.")+"<br/>"),n!=""&&(n=n),$("input[type=text], textarea").each(function(){var t=$(this);if(xRegExpEmojiKontrol.test(t.val()))return n+=" * "+Translate("Maalesef Emoji Kabul Edemiyoruz :(")+"<br/>"}),n}function YeniKulllaniciGirisChangeAyarla(){$("#YeniKullanici_YeniTcNO, #YeniKullanici_YeniEmail, #YeniKullanici_YeniGSM").change(function(){tcKontrol()})}function tcKontrol(){if($("#YeniKullanici_YeniTcNO").val()!=""){var n=$("#YeniKullanici_YeniTcNO").val();return $.ajax({url:"/Bagis/TcKontrolHizliBagisci",data:"tcNo="+n,type:"POST",async:!1,success:function(n){n.Durum?tcDurum=!0:(tcDurum=!1,MsgBox("error",n.Mesaj,Translate("Upss! Birşeyler Yanlış Gitti")))}}),tcDurum}return!0}function KullaniciIptal(){$.ajax({url:"/Bagis/KullaniciGirisIptal",type:"POST",async:!1,success:function(n){n.Durum&&($("h3.Mesaj").html(""),$("#BagisciId").val(""),$("#YeniKullanici_BagisciVar").val(!1))},error:function(){hasError=!0;alert("İşlem gerçekleştirilemedi, lütfen internet bağlantınızı kontrol edip tekrar deneyiniz")}});AntiForgeryTokenOlustur()}function yeniKullaniciUlkeDegisti(){if($("#YeniKullanici_Ilce").find("option").remove(),$("#YeniKullanici_Ilce").append("<option value=''>- "+Translate("- Seçiniz -")+" -<\/option>"),$("#YeniKullanici_Ulke").val()!=""){var n=$("#YeniKullanici_Ulke").val();$.ajax({url:"/Bagis/IlListesi",data:"UlkeKodu="+n,type:"POST",async:!1,success:function(n){$("#YeniKullanici_Sehir").find("option").remove();$.isEmptyObject(n)?$("#YeniKullanici_Sehir").append("<option value=''>- "+Translate("Şehir Bulunamadı")+" -<\/option>"):$.each(n,function(t){$("#YeniKullanici_Sehir").append("<option value='"+n[t].Value+"'>"+n[t].Text+"<\/option>")})},error:function(){alert("İller getirilemedi, lütfen internet bağlantınızı kontrol edip tekrar deneyiniz")}})}else $("#YeniKullanici_Sehir").find("option").remove(),$("#YeniKullanici_Sehir").append("<option value=''>- "+Translate("- Seçiniz -")+" -<\/option>")}function yeniKullaniciSehirDegisti(){if($("#YeniKullanici_Sehir").val()==""||$("#YeniKullanici_Ulke").val()!="TR")$("#YeniKullanici_Ilce").find("option").remove(),$("#YeniKullanici_Ilce").append("<option value=''>- "+Translate("İlçe Bulunamadı")+" -<\/option>");else{var n=$("#YeniKullanici_Sehir").val();$.ajax({url:"/Bagis/IlceListesi",data:"IlKodu="+n,type:"POST",async:!1,success:function(n){$("#YeniKullanici_Ilce").find("option").remove();$.isEmptyObject(n)?$("#YeniKullanici_Ilce").append("<option value=''>- "+Translate("İlçe Bulunamadı")+" -<\/option>"):$.each(n,function(t){$("#YeniKullanici_Ilce").append("<option value='"+n[t].Value+"'>"+n[t].Text+"<\/option>")})},error:function(){alert("İlçeler getirilemedi, lütfen tekrar deneyiniz")}})}}function SifremiUnuttumAyarla(){try{$(".login input[type='radio']").change(function(){$(".login .KodHeader").html($(this).data("val"));$(".login #Kod").val("")})}catch(n){}}function KrediKartNeteKapamaUyariGoster(){if($.cookie("kizilaykredikartuyari")==null){MsgBox("info",'<img class="rounded" src="/Upload/Editor/images/web_kamuoyu_aciklama_kurban_2018.jpg"/>',Translate("Önemli Uyarı"));var n=new Date;n.setTime(n.getTime()+24e5);$.cookie("kizilaykredikartuyari",1,{expires:n,path:"/"})}}function CaptchaDondur(){return $("#CaptchaAcik").val().toLowerCase()==="true"?grecaptcha.getResponse():""}function ParaBirimiDegisti(){let t=$("input[name='ParaBirimi']:checked").val();$(".parabirimikod").val(t);let n="TL";switch(t){case"949":n="TL";break;case"840":n="US";break;case"978":n="EU";break;default:n="TL"}$(".parabirimikodYKB").val(n);t=="949"?$(".duzenliveilave").show():($(".duzenliveilave").hide(),$("#DuzenliBagisYapmakIstiyorum").prop("checked",!1),$("#EkBagisDurumu").prop("checked",!1),TutarHesapla());let i=paraBirimiIsoToShort(t);$(".fa-try,.fa-usd,.fa-eur").addClass("parabirimsimgesiekle").removeClass("fa-try").removeClass("fa-usd").removeClass("fa-eur");$(".parabirimsimgesiekle").addClass("fa-"+i).removeClass("parabirimsimgesiekle");$("#BirimFiyati").length&&($("#BirimFiyati").val($("#BirimFiyat"+i.charAt(0).toUpperCase()+i.slice(1)).val()),TutarHesapla())}function paraBirimiIsoToShort(n){switch(n){case"949":return"try";case"840":return"usd";case"978":return"eur";default:return"try"}}$.urlParam=function(n){var t=new RegExp("[?&]"+n+"=([^&#]*)").exec(window.location.search);return t!==null?t[1]||0:!1};const xRegExpEmojiKontrol=XRegExp("\\p{Cs}");window.addEventListener("pageshow",function(n){var t=n.persisted||typeof performance!="undefined"&&window.performance.navigation.type===2;if(t){try{grecaptcha.reset()}catch(i){}ParaBirimiDegisti();$(".btn_bagisyap").show();loadingGizle()}});$(document).ready(function(){(GetURLParameter()=="fitre"||GetURLParameter()=="fidye"||GetURLParameter()=="fidya"||GetURLParameter()=="fitra")&&$("#BagisTutari").val("40");var n=$.urlParam("bagisadeti");n!=!1&&($("#BagisAdeti").val(n),$.urlParam("ppac")!=3&&bagisciAdetiDuzenle());$.urlParam("ozelbagis")=="db"&&($("#divBagisciNotu").hide(),$("#divYonlendirenSube").hide(),$("#divBagisNasilYapilir").hide(),$("#KvkkIsaretlendi").prop("checked",!0),$("#tab-container").easytabs("select","#tabs-Bilgi"),$("html, body").animate({scrollTop:0},1),$("#YeniKullanici_YeniAd").val("Deutsche"),$("#YeniKullanici_YeniSoyad").val("Bank"),$("#YeniKullanici_YeniEmail").val("deutschebank@db.com"));DuzenliBagisYapmakIstiyorum();DuzenliBagisAdetDegistir();BagisciGirisiTabla();SifremiUnuttumAyarla();BagisYapAdAyarla();TutarHesapla();$("#DuzenliBagisYapmakIstiyorum").on("change",function(){DuzenliBagisYapmakIstiyorum()});$("#YonlendirenSubeSehir").change(function(){if($(this).val()!=""){var n=$(this).val();$.ajax({url:"/Bagis/SubeListesi",data:"IlKodu="+n,type:"POST",async:!1,success:function(n){$("#YonlendirenSube").find("option").remove();$.isEmptyObject(n)?$("#YonlendirenSube").append("<option value='0'>"+Translate("Yok")+" <\/option>"):$.each(n,function(t){$("#YonlendirenSube").append("<option value='"+n[t].Value+"'>"+n[t].Text+"<\/option>")})},error:function(){alert("Şubeler getirilemedi, lütfen internet bağlantınızı kontrol edip tekrar deneyiniz")}})}});$("input[type=radio][name=ParaBirimi]").change(function(){ParaBirimiDegisti()})});YeniKulllaniciGirisChangeAyarla();$("#YeniKullanici_Ulke").change(function(){yeniKullaniciUlkeDegisti()});$("#YeniKullanici_Sehir").change(function(){yeniKullaniciSehirDegisti()})